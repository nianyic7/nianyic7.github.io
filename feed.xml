<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.3.2">Jekyll</generator><link href="https://nianyic7.github.io/feed.xml" rel="self" type="application/atom+xml"/><link href="https://nianyic7.github.io/" rel="alternate" type="text/html" hreflang="en"/><updated>2023-08-17T18:40:15+00:00</updated><id>https://nianyic7.github.io/feed.xml</id><title type="html">blank</title><subtitle>A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. </subtitle><entry><title type="html">a post with custom blockquotes</title><link href="https://nianyic7.github.io/blog/2023/custom-blockquotes/" rel="alternate" type="text/html" title="a post with custom blockquotes"/><published>2023-05-12T19:53:00+00:00</published><updated>2023-05-12T19:53:00+00:00</updated><id>https://nianyic7.github.io/blog/2023/custom-blockquotes</id><content type="html" xml:base="https://nianyic7.github.io/blog/2023/custom-blockquotes/"><![CDATA[<p>This post shows how to add custom styles for blockquotes. Based on <a href="https://github.com/sighingnow/jekyll-gitbook">jekyll-gitbook</a> implementation.</p> <p>We decided to support the same custom blockquotes as in <a href="https://sighingnow.github.io/jekyll-gitbook/jekyll/2022-06-30-tips_warnings_dangers.html">jekyll-gitbook</a>, which are also found in a lot of other sites’ styles. The styles definitions can be found on the <a href="https://github.com/alshedivat/al-folio/blob/master/_sass/_base.scss">_base.scss</a> file, more specifically:</p> <div class="language-scss highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/* Tips, warnings, and dangers */</span>
<span class="nc">.post</span> <span class="nc">.post-content</span> <span class="nt">blockquote</span> <span class="p">{</span>
    <span class="k">&amp;</span><span class="nc">.block-tip</span> <span class="p">{</span>
    <span class="nl">border-color</span><span class="p">:</span> <span class="nf">var</span><span class="p">(</span><span class="o">--</span><span class="n">global-tip-block</span><span class="p">);</span>
    <span class="nl">background-color</span><span class="p">:</span> <span class="nf">var</span><span class="p">(</span><span class="o">--</span><span class="n">global-tip-block-bg</span><span class="p">);</span>

    <span class="nt">p</span> <span class="p">{</span>
      <span class="nl">color</span><span class="p">:</span> <span class="nf">var</span><span class="p">(</span><span class="o">--</span><span class="n">global-tip-block-text</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nt">h1</span><span class="o">,</span> <span class="nt">h2</span><span class="o">,</span> <span class="nt">h3</span><span class="o">,</span> <span class="nt">h4</span><span class="o">,</span> <span class="nt">h5</span><span class="o">,</span> <span class="nt">h6</span> <span class="p">{</span>
      <span class="nl">color</span><span class="p">:</span> <span class="nf">var</span><span class="p">(</span><span class="o">--</span><span class="n">global-tip-block-title</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">&amp;</span><span class="nc">.block-warning</span> <span class="p">{</span>
    <span class="nl">border-color</span><span class="p">:</span> <span class="nf">var</span><span class="p">(</span><span class="o">--</span><span class="n">global-warning-block</span><span class="p">);</span>
    <span class="nl">background-color</span><span class="p">:</span> <span class="nf">var</span><span class="p">(</span><span class="o">--</span><span class="n">global-warning-block-bg</span><span class="p">);</span>

    <span class="nt">p</span> <span class="p">{</span>
      <span class="nl">color</span><span class="p">:</span> <span class="nf">var</span><span class="p">(</span><span class="o">--</span><span class="n">global-warning-block-text</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nt">h1</span><span class="o">,</span> <span class="nt">h2</span><span class="o">,</span> <span class="nt">h3</span><span class="o">,</span> <span class="nt">h4</span><span class="o">,</span> <span class="nt">h5</span><span class="o">,</span> <span class="nt">h6</span> <span class="p">{</span>
      <span class="nl">color</span><span class="p">:</span> <span class="nf">var</span><span class="p">(</span><span class="o">--</span><span class="n">global-warning-block-title</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">&amp;</span><span class="nc">.block-danger</span> <span class="p">{</span>
    <span class="nl">border-color</span><span class="p">:</span> <span class="nf">var</span><span class="p">(</span><span class="o">--</span><span class="n">global-danger-block</span><span class="p">);</span>
    <span class="nl">background-color</span><span class="p">:</span> <span class="nf">var</span><span class="p">(</span><span class="o">--</span><span class="n">global-danger-block-bg</span><span class="p">);</span>

    <span class="nt">p</span> <span class="p">{</span>
      <span class="nl">color</span><span class="p">:</span> <span class="nf">var</span><span class="p">(</span><span class="o">--</span><span class="n">global-danger-block-text</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nt">h1</span><span class="o">,</span> <span class="nt">h2</span><span class="o">,</span> <span class="nt">h3</span><span class="o">,</span> <span class="nt">h4</span><span class="o">,</span> <span class="nt">h5</span><span class="o">,</span> <span class="nt">h6</span> <span class="p">{</span>
      <span class="nl">color</span><span class="p">:</span> <span class="nf">var</span><span class="p">(</span><span class="o">--</span><span class="n">global-danger-block-title</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>A regular blockquote can be used as following:</p> <div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gt">&gt; This is a regular blockquote</span>
<span class="gt">&gt; and it can be used as usual</span>
</code></pre></div></div> <blockquote> <p>This is a regular blockquote and it can be used as usual</p> </blockquote> <p>These custom styles can be used by adding the specific class to the blockquote, as follows:</p> <div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gt">&gt; ##### TIP</span>
<span class="gt">&gt;</span>
<span class="gt">&gt; A tip can be used when you want to give advice</span>
<span class="gt">&gt; related to a certain content.</span>
{: .block-tip }
</code></pre></div></div> <blockquote class="block-tip"> <h5 id="tip">TIP</h5> <p>A tip can be used when you want to give advice related to a certain content.</p> </blockquote> <div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gt">&gt; ##### WARNING</span>
<span class="gt">&gt;</span>
<span class="gt">&gt; This is a warning, and thus should</span>
<span class="gt">&gt; be used when you want to warn the user</span>
{: .block-warning }
</code></pre></div></div> <blockquote class="block-warning"> <h5 id="warning">WARNING</h5> <p>This is a warning, and thus should be used when you want to warn the user</p> </blockquote> <div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gt">&gt; ##### DANGER</span>
<span class="gt">&gt;</span>
<span class="gt">&gt; This is a danger zone, and thus should</span>
<span class="gt">&gt; be used carefully</span>
{: .block-danger }
</code></pre></div></div> <blockquote class="block-danger"> <h5 id="danger">DANGER</h5> <p>This is a danger zone, and thus should be used carefully</p> </blockquote>]]></content><author><name></name></author><category term="sample-posts"/><category term="blockquotes"/><summary type="html"><![CDATA[an example of a blog post with custom blockquotes]]></summary></entry><entry><title type="html">a post with table of contents on a sidebar</title><link href="https://nianyic7.github.io/blog/2023/sidebar-table-of-contents/" rel="alternate" type="text/html" title="a post with table of contents on a sidebar"/><published>2023-04-25T14:14:00+00:00</published><updated>2023-04-25T14:14:00+00:00</updated><id>https://nianyic7.github.io/blog/2023/sidebar-table-of-contents</id><content type="html" xml:base="https://nianyic7.github.io/blog/2023/sidebar-table-of-contents/"><![CDATA[<p>This post shows how to add a table of contents as a sidebar.</p> <h2 id="adding-a-table-of-contents">Adding a Table of Contents</h2> <p>To add a table of contents to a post as a sidebar, simply add</p> <div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">toc</span><span class="pi">:</span>
  <span class="na">sidebar</span><span class="pi">:</span> <span class="s">left</span>
</code></pre></div></div> <p>to the front matter of the post. The table of contents will be automatically generated from the headings in the post. If you wish to display the sidebar to the right, simply change <code class="language-plaintext highlighter-rouge">left</code> to <code class="language-plaintext highlighter-rouge">right</code>.</p> <h3 id="example-of-sub-heading-1">Example of Sub-Heading 1</h3> <p>Jean shorts raw denim Vice normcore, art party High Life PBR skateboard stumptown vinyl kitsch. Four loko meh 8-bit, tousled banh mi tilde forage Schlitz dreamcatcher twee 3 wolf moon. Chambray asymmetrical paleo salvia, sartorial umami four loko master cleanse drinking vinegar brunch. <a href="https://www.pinterest.com">Pinterest</a> DIY authentic Schlitz, hoodie Intelligentsia butcher trust fund brunch shabby chic Kickstarter forage flexitarian. Direct trade <a href="https://en.wikipedia.org/wiki/Cold-pressed_juice">cold-pressed</a> meggings stumptown plaid, pop-up taxidermy. Hoodie XOXO fingerstache scenester Echo Park. Plaid ugh Wes Anderson, freegan pug selvage fanny pack leggings pickled food truck DIY irony Banksy.</p> <h3 id="example-of-another-sub-heading-1">Example of another Sub-Heading 1</h3> <p>Jean shorts raw denim Vice normcore, art party High Life PBR skateboard stumptown vinyl kitsch. Four loko meh 8-bit, tousled banh mi tilde forage Schlitz dreamcatcher twee 3 wolf moon. Chambray asymmetrical paleo salvia, sartorial umami four loko master cleanse drinking vinegar brunch. <a href="https://www.pinterest.com">Pinterest</a> DIY authentic Schlitz, hoodie Intelligentsia butcher trust fund brunch shabby chic Kickstarter forage flexitarian. Direct trade <a href="https://en.wikipedia.org/wiki/Cold-pressed_juice">cold-pressed</a> meggings stumptown plaid, pop-up taxidermy. Hoodie XOXO fingerstache scenester Echo Park. Plaid ugh Wes Anderson, freegan pug selvage fanny pack leggings pickled food truck DIY irony Banksy.</p> <h2 data-toc-text="Customizing" id="customizing-your-table-of-contents">Customizing Your Table of Contents</h2> <p>If you want to learn more about how to customize the table of contents of your sidebar, you can check the <a href="https://afeld.github.io/bootstrap-toc/">bootstrap-toc</a> documentation. Notice that you can even customize the text of the heading that will be displayed on the sidebar.</p> <h3 id="example-of-sub-heading-2">Example of Sub-Heading 2</h3> <p>Jean shorts raw denim Vice normcore, art party High Life PBR skateboard stumptown vinyl kitsch. Four loko meh 8-bit, tousled banh mi tilde forage Schlitz dreamcatcher twee 3 wolf moon. Chambray asymmetrical paleo salvia, sartorial umami four loko master cleanse drinking vinegar brunch. <a href="https://www.pinterest.com">Pinterest</a> DIY authentic Schlitz, hoodie Intelligentsia butcher trust fund brunch shabby chic Kickstarter forage flexitarian. Direct trade <a href="https://en.wikipedia.org/wiki/Cold-pressed_juice">cold-pressed</a> meggings stumptown plaid, pop-up taxidermy. Hoodie XOXO fingerstache scenester Echo Park. Plaid ugh Wes Anderson, freegan pug selvage fanny pack leggings pickled food truck DIY irony Banksy.</p> <h3 id="example-of-another-sub-heading-2">Example of another Sub-Heading 2</h3> <p>Jean shorts raw denim Vice normcore, art party High Life PBR skateboard stumptown vinyl kitsch. Four loko meh 8-bit, tousled banh mi tilde forage Schlitz dreamcatcher twee 3 wolf moon. Chambray asymmetrical paleo salvia, sartorial umami four loko master cleanse drinking vinegar brunch. <a href="https://www.pinterest.com">Pinterest</a> DIY authentic Schlitz, hoodie Intelligentsia butcher trust fund brunch shabby chic Kickstarter forage flexitarian. Direct trade <a href="https://en.wikipedia.org/wiki/Cold-pressed_juice">cold-pressed</a> meggings stumptown plaid, pop-up taxidermy. Hoodie XOXO fingerstache scenester Echo Park. Plaid ugh Wes Anderson, freegan pug selvage fanny pack leggings pickled food truck DIY irony Banksy.</p>]]></content><author><name></name></author><category term="sample-posts"/><category term="toc"/><category term="sidebar"/><summary type="html"><![CDATA[an example of a blog post with table of contents on a sidebar]]></summary></entry><entry><title type="html">a post with audios</title><link href="https://nianyic7.github.io/blog/2023/audios/" rel="alternate" type="text/html" title="a post with audios"/><published>2023-04-25T10:25:00+00:00</published><updated>2023-04-25T10:25:00+00:00</updated><id>https://nianyic7.github.io/blog/2023/audios</id><content type="html" xml:base="https://nianyic7.github.io/blog/2023/audios/"><![CDATA[<p>This is an example post with audios. It supports local audio files.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <audio src="/assets/audio/epicaly-short-113909.mp3" controls=""/> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <audio src="https://cdn.pixabay.com/download/audio/2022/06/25/audio_69a61cd6d6.mp3" controls=""/> </figure> </div> </div> <div class="caption"> A simple, elegant caption looks good between video rows, after each row, or doesn't have to be there at all. </div>]]></content><author><name></name></author><category term="sample-posts"/><category term="including"/><category term="audios"/><summary type="html"><![CDATA[this is what included audios could look like]]></summary></entry><entry><title type="html">a post with videos</title><link href="https://nianyic7.github.io/blog/2023/videos/" rel="alternate" type="text/html" title="a post with videos"/><published>2023-04-24T21:01:00+00:00</published><updated>2023-04-24T21:01:00+00:00</updated><id>https://nianyic7.github.io/blog/2023/videos</id><content type="html" xml:base="https://nianyic7.github.io/blog/2023/videos/"><![CDATA[<p>This is an example post with videos. It supports local video files.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <video src="/assets/video/pexels-engin-akyurt-6069112-960x540-30fps.mp4" class="img-fluid rounded z-depth-1" width="auto" height="auto" autoplay="" controls=""/> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <video src="/assets/video/pexels-engin-akyurt-6069112-960x540-30fps.mp4" class="img-fluid rounded z-depth-1" width="auto" height="auto" controls=""/> </figure> </div> </div> <div class="caption"> A simple, elegant caption looks good between video rows, after each row, or doesn't have to be there at all. </div> <p>It does also support embedding videos from different sources. Here are some examples:</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <iframe src="https://www.youtube.com/embed/jNQXAC9IVRw" class="img-fluid rounded z-depth-1" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="" width="auto" height="auto"/> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <iframe src="https://player.vimeo.com/video/524933864?h=1ac4fd9fb4&amp;title=0&amp;byline=0&amp;portrait=0" class="img-fluid rounded z-depth-1" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="" width="auto" height="auto"/> </figure> </div> </div>]]></content><author><name></name></author><category term="sample-posts"/><category term="including"/><category term="videos"/><summary type="html"><![CDATA[this is what included videos could look like]]></summary></entry><entry><title type="html">displaying beautiful tables with Bootstrap Tables</title><link href="https://nianyic7.github.io/blog/2023/tables/" rel="alternate" type="text/html" title="displaying beautiful tables with Bootstrap Tables"/><published>2023-03-20T18:37:00+00:00</published><updated>2023-03-20T18:37:00+00:00</updated><id>https://nianyic7.github.io/blog/2023/tables</id><content type="html" xml:base="https://nianyic7.github.io/blog/2023/tables/"><![CDATA[<p>Using markdown to display tables is easy. Just use the following syntax:</p> <div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code>| Left aligned | Center aligned | Right aligned |
| :----------- | :------------: | ------------: |
| Left 1       | center 1       | right 1       |
| Left 2       | center 2       | right 2       |
| Left 3       | center 3       | right 3       |
</code></pre></div></div> <p>That will generate:</p> <table> <thead> <tr> <th style="text-align: left">Left aligned</th> <th style="text-align: center">Center aligned</th> <th style="text-align: right">Right aligned</th> </tr> </thead> <tbody> <tr> <td style="text-align: left">Left 1</td> <td style="text-align: center">center 1</td> <td style="text-align: right">right 1</td> </tr> <tr> <td style="text-align: left">Left 2</td> <td style="text-align: center">center 2</td> <td style="text-align: right">right 2</td> </tr> <tr> <td style="text-align: left">Left 3</td> <td style="text-align: center">center 3</td> <td style="text-align: right">right 3</td> </tr> </tbody> </table> <p></p> <p>It is also possible to use HTML to display tables. For example, the following HTML code will display a table with <a href="https://bootstrap-table.com/">Bootstrap Table</a>, loaded from a JSON file:</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;table</span>
  <span class="na">id=</span><span class="s">"table"</span>
  <span class="na">data-toggle=</span><span class="s">"table"</span>
  <span class="na">data-url=</span><span class="s">"{{ '/assets/json/table_data.json' | relative_url }}"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;thead&gt;</span>
    <span class="nt">&lt;tr&gt;</span>
      <span class="nt">&lt;th</span> <span class="na">data-field=</span><span class="s">"id"</span><span class="nt">&gt;</span>ID<span class="nt">&lt;/th&gt;</span>
      <span class="nt">&lt;th</span> <span class="na">data-field=</span><span class="s">"name"</span><span class="nt">&gt;</span>Item Name<span class="nt">&lt;/th&gt;</span>
      <span class="nt">&lt;th</span> <span class="na">data-field=</span><span class="s">"price"</span><span class="nt">&gt;</span>Item Price<span class="nt">&lt;/th&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
  <span class="nt">&lt;/thead&gt;</span>
<span class="nt">&lt;/table&gt;</span>
</code></pre></div></div> <table data-toggle="table" data-url="/assets/json/table_data.json"> <thead> <tr> <th data-field="id">ID</th> <th data-field="name">Item Name</th> <th data-field="price">Item Price</th> </tr> </thead> </table> <p></p> <p>By using <a href="https://bootstrap-table.com/">Bootstrap Table</a> it is possible to create pretty complex tables, with pagination, search, and more. For example, the following HTML code will display a table, loaded from a JSON file, with pagination, search, checkboxes, and header/content alignment. For more information, check the <a href="https://examples.bootstrap-table.com/index.html">documentation</a>.</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;table</span>
  <span class="na">data-click-to-select=</span><span class="s">"true"</span>
  <span class="na">data-height=</span><span class="s">"460"</span>
  <span class="na">data-pagination=</span><span class="s">"true"</span>
  <span class="na">data-search=</span><span class="s">"true"</span>
  <span class="na">data-toggle=</span><span class="s">"table"</span>
  <span class="na">data-url=</span><span class="s">"{{ '/assets/json/table_data.json' | relative_url }}"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;thead&gt;</span>
    <span class="nt">&lt;tr&gt;</span>
      <span class="nt">&lt;th</span> <span class="na">data-checkbox=</span><span class="s">"true"</span><span class="nt">&gt;&lt;/th&gt;</span>
      <span class="nt">&lt;th</span> <span class="na">data-field=</span><span class="s">"id"</span> <span class="na">data-halign=</span><span class="s">"left"</span> <span class="na">data-align=</span><span class="s">"center"</span> <span class="na">data-sortable=</span><span class="s">"true"</span><span class="nt">&gt;</span>ID<span class="nt">&lt;/th&gt;</span>
      <span class="nt">&lt;th</span> <span class="na">data-field=</span><span class="s">"name"</span> <span class="na">data-halign=</span><span class="s">"center"</span> <span class="na">data-align=</span><span class="s">"right"</span> <span class="na">data-sortable=</span><span class="s">"true"</span><span class="nt">&gt;</span>Item Name<span class="nt">&lt;/th&gt;</span>
      <span class="nt">&lt;th</span> <span class="na">data-field=</span><span class="s">"price"</span> <span class="na">data-halign=</span><span class="s">"right"</span> <span class="na">data-align=</span><span class="s">"left"</span> <span class="na">data-sortable=</span><span class="s">"true"</span><span class="nt">&gt;</span>Item Price<span class="nt">&lt;/th&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
  <span class="nt">&lt;/thead&gt;</span>
<span class="nt">&lt;/table&gt;</span>
</code></pre></div></div> <table data-click-to-select="true" data-height="460" data-pagination="true" data-search="true" data-toggle="table" data-url="/assets/json/table_data.json"> <thead> <tr> <th data-checkbox="true"></th> <th data-field="id" data-halign="left" data-align="center" data-sortable="true">ID</th> <th data-field="name" data-halign="center" data-align="right" data-sortable="true">Item Name</th> <th data-field="price" data-halign="right" data-align="left" data-sortable="true">Item Price</th> </tr> </thead> </table>]]></content><author><name></name></author><category term="sample-posts"/><summary type="html"><![CDATA[an example of how to use Bootstrap Tables]]></summary></entry><entry><title type="html">a post with table of contents</title><link href="https://nianyic7.github.io/blog/2023/table-of-contents/" rel="alternate" type="text/html" title="a post with table of contents"/><published>2023-03-20T15:59:00+00:00</published><updated>2023-03-20T15:59:00+00:00</updated><id>https://nianyic7.github.io/blog/2023/table-of-contents</id><content type="html" xml:base="https://nianyic7.github.io/blog/2023/table-of-contents/"><![CDATA[<p>This post shows how to add a table of contents in the beginning of the post.</p> <h1 id="mp-gadget-code-notes">MP-Gadget Code Notes</h1> <p>Useful resources for understanding cosmological simulations:</p> <ul> <li><a href="http://popia.ft.uam.es/aknebe/page3/files/ComputationalCosmology/">Alexander Knebe’s lecture notes</a></li> <li><a href="https://wwwmpa.mpa-garching.mpg.de/gadget4/gadget4-code-paper.pdf">gadget4 paper</a></li> <li><a href="https://arxiv.org/pdf/astro-ph/9710043.pdf">Quinn97: Time stepping N-body simulations</a></li> <li><a href="https://arxiv.org/pdf/astro-ph/0411730.pdf">Bagla04: Cosmological N-Body Simulations</a></li> <li><a href="https://arxiv.org/pdf/0801.1023.pdf">Dolag08: Simulation techniques for cosmological simulations</a></li> <li><a href="https://workshops.ift.uam-csic.es/uploads/charla/275/Yepes_nbody.pdf">Yepes Nbody Slides and references therein</a></li> <li><a href="http://popia.ft.uam.es/ACO/links.html">Knebe’s lecture</a></li> </ul> <h2 id="overview">Overview</h2> <p>(simplified pseudo-code for the main loop in <code class="language-plaintext highlighter-rouge">run.c</code>)</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>-------- Initializations ------------
hci_init (what is HCI?)
get_unit_system (independent of a)
gravpm_init_periodic
DriftKickTimes times = init_driftkicktime(ti_init)
atime = get_atime(times.Ti_Current)

----------- Main Loop -------------
times.Ti_Current = find_next_kick(times.Ti_Current, times.mintimebin);
atime = get_atime(times.Ti_Current);
if pm and all.randomoffset:
	update_random_offset(PartManager, rel_random_shift, All.RandomParticleOffset)

#--------- Drift/Ddcomp ----------
if PM_step or active_timebin:
	drift_all_particles(Ti_Last, times.Ti_Current, &amp;All.CP, rel_random_shift)
	domain_decompose_full(ddecomp)
	
update_lastactive_drift(&amp;times);

build_active_particles(&amp;Act, &amp;times, NumCurrentTiStep, atime);

#----------- Hydro ---------------
density(&amp;Act, 1, DensityIndependentSphOn(), All.BlackHoleOn, times, &amp;All.CP, &amp;sph_predicted, GradRho_mag, &amp;gasTree)
# update smoothing lengths in tree
force_update_hmax(Act.ActiveParticle, Act.NumActiveParticle, &amp;gasTree, ddecomp);
hydro_force(&amp;Act, atime, &amp;sph_predicted, times, &amp;All.CP, &amp;gasTree);

#---------- PM --------------------
force_tree_full(&amp;Tree, ddecomp, HybridNuTracer, All.OutputDir);
gravpm_force(&amp;pm, &amp;Tree, &amp;All.CP, atime, units.UnitLength_in_cm, All.OutputDir, header-&gt;TimeIC, All.FastParticleType);

#--------- Tree ------------------
force_tree_full(&amp;Tree, ddecomp, HybridNuTracer, All.OutputDir);
grav_short_tree(&amp;Act, &amp;pm, &amp;Tree, NULL, rho0, HybridNuTracer, All.FastParticleType, times.Ti_Current);

#--------- First Half Kick ------------------
apply_half_kick(&amp;Act, &amp;All.CP, &amp;times, atime); # both grav and hydro
update_kick_times(&amp;times);
if pm:
	apply_PM_half_kick(&amp;All.CP, &amp;times);
	
#------- Cooling and extra physics --------
metal_return();
fof_seed(); # seed BH
do_heiii_reionization();
calculate_uvbg();
blackhole();
cooling_and_starformation();
force_tree_free(&amp;Tree);

#--------- Output ----------------
if(WriteSnapshot):
	write_checkpoint();
	fof_save_groups();
 write_cpu_log();

#---------- Second half kick --------
find_timesteps(&amp;Act, &amp;times, atime, All.FastParticleType, &amp;All.CP, asmth, NumCurrentTiStep == 0);
apply_half_kick(&amp;Act, &amp;All.CP, &amp;times, atime);
update_kick_times(&amp;times);
apply_PM_half_kick(&amp;All.CP, &amp;times);

</code></pre></div></div> <h2 id="io">I/O</h2> <p>Driver:</p> <p><code class="language-plaintext highlighter-rouge">checkpoint.c/write_checkpoint(int snapnum, int WriteGroupID, int MetalReturnOn, double Time, const Cosmology * CP, const char * OutputDir, const int OutputDebugFields)</code></p> <p><code class="language-plaintext highlighter-rouge">petaio.c/petaio_save_snapshot(const char * fname, struct IOTable * IOTable, int verbose, const double atime, const Cosmology * CP)</code></p> <h2 id="time-integration">Time integration</h2> <p>Detailed time integration scheme can be find in Section 4 of the <a href="https://wwwmpa.mpa-garching.mpg.de/gadget4/gadget4-code-paper.pdf">gadget4 paper</a>, also see <a href="https://arxiv.org/pdf/astro-ph/9710043.pdf">Quinn1997</a>: \(\mathbf{x}\left(\tau_n+\Delta \tau\right)=\mathbf{x}\left(\tau_n\right)+\mathbf{p}_n\left(\tau_n\right) \int_{\tau_n}^{\tau_n+\Delta \tau} \frac{\mathrm{d} \tau}{a^2 H(a)}\)</p> \[\mathbf{p}\left(\tau_n+\Delta \tau\right)=\mathbf{p}\left(\tau_n\right)+\mathbf{a}_n\left(\tau_n\right) \int_{\tau_n}^{\tau_n+\Delta \tau} \frac{\mathrm{d} \tau}{a H(a)}\] <p>where $\mathbf{p} = a^2\dot{\mathbf{x}}$, $\mathbf{a} = a\dot{\mathbf{p}}$, $\tau = log(a)$, $dt = dlog(a)/H(a)$.</p> <p><strong>Relation with physical quantities</strong></p> <p>$\mathbf{r},\mathbf{v},\mathbf{f}$ are physical distance, velocity and acceleration; $\mathbf{x},\mathbf{p},\mathbf{a}$ are code distance, velocity and acceleration. \(\mathbf{r} = a \mathbf{x}\) \(\mathbf{v} = d\mathbf{r}/dt = \frac{1}{a}\mathbf{p} + \dot{a}\mathbf{x}\) \(\mathbf{f} = d\mathbf{v}/dt = \dot{\mathbf{p}}/a + \ddot{a}\mathbf{x} = \frac{1}{a^2} \mathbf{a} + \ddot{a} \mathbf{x}\)</p> <p><strong><a href="https://github.com/N-BodyShop/changa/wiki/ChaNGa-User-Guide#changa-with-black-holes">ChaNGa Notes</a></strong></p> <blockquote> <p>Here be Dragons.</p> <p>Going from comoving distance to physical distance is straightforward: r_phys = a r_cm. Physical velocity requires including the Hubble flow: v_phys = a (v_cm + H r_cm), where H is the hubble constant at the given redshift. Beware that v_circular is calculated differently, and therefore scales differently: v_c_phys = v_c_cm/sqrt(a). Finally, sometimes you want to know the ratio of the density to the critical density (e.g. to calculate the virial radius). This depends on cosmology. For Lambda + Matter critical Universes, we have rho/rho_c = rho_cm/(a^3 Omega_Lambda + Omega_matter), where the Omegas are present values and rho_c at the present is 1 as described above.</p> </blockquote> <p><strong>In MP-gadget</strong></p> <p><code class="language-plaintext highlighter-rouge">get_exact_draft_fac</code> called in <code class="language-plaintext highlighter-rouge">drift.c</code>,<code class="language-plaintext highlighter-rouge">exchange.c</code>,<code class="language-plaintext highlighter-rouge">hydra.c</code>,<code class="language-plaintext highlighter-rouge">lightcone.c</code></p> <p><code class="language-plaintext highlighter-rouge">get_exact_gravkick_fac</code> called in <code class="language-plaintext highlighter-rouge">blackhole.c</code>,<code class="language-plaintext highlighter-rouge">density.c</code>,<code class="language-plaintext highlighter-rouge">hydra.c</code>,<code class="language-plaintext highlighter-rouge">timestep.c</code>,<code class="language-plaintext highlighter-rouge">wind.c</code></p> <p>In <code class="language-plaintext highlighter-rouge">drift.c</code></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ddrift = get_exact_drift_factor(CP, ti0, ti1);
pp-&gt;Pos[j] += pp-&gt;Vel[j] * ddrift + random_shift[j];
</code></pre></div></div> <p>In <code class="language-plaintext highlighter-rouge">timefac.c</code>:</p> <p><code class="language-plaintext highlighter-rouge">drift_integ(a)</code> = $1/H(a)/a^3$</p> <p><code class="language-plaintext highlighter-rouge">gravkick_integ(a)</code> = $1/H(a)/a^2$</p> <p><code class="language-plaintext highlighter-rouge">hydrokick_integ(a)</code> = $1/H(a)/a^{3(\gamma-1)+1}$</p> <p><code class="language-plaintext highlighter-rouge">get_exact_factor(a)</code>: integrate draft/kick factor from t0 to t1 \(\int_{a0}^{a1} fac(a)\,da\)</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>a0 = exp(loga_from_ti(t0))
</code></pre></div></div> <h4 id="note-on-hubble">note on hubble</h4> <p><code class="language-plaintext highlighter-rouge">CP-&gt;HubbleParam</code>: little h unit of 100km/s/Mpc</p> <p><code class="language-plaintext highlighter-rouge">CP-&gt;Hubble</code>: <code class="language-plaintext highlighter-rouge">CP-&gt;Hubble = HUBBLE * units.UnitTime_in_s</code>, 100km/s/Mpc in internal unit; set to 0.1 by default</p> <p><code class="language-plaintext highlighter-rouge">HUBBLE</code>: <code class="language-plaintext highlighter-rouge">#define HUBBLE 3.2407789e-18 /* in h/sec */</code> = 100 km/s/Mpc in cgs</p> <p><code class="language-plaintext highlighter-rouge">HUBBLE * CP-&gt;HubbleParam</code>: hubble constant at z=0 in cgs</p> <p><code class="language-plaintext highlighter-rouge">CP-&gt;Hubble * CP-&gt;HubbleParam</code>: hubble constant at z=0 in internal time unit (UnitTime_in_s, 978 Myr)</p> <p><code class="language-plaintext highlighter-rouge">hubble_func(a) * CP-&gt;HubbleParam</code>: hubble constant at z in internal time unit</p> <p><code class="language-plaintext highlighter-rouge">UnitTime_in_s = 3.08568e+16</code>: chose such that <code class="language-plaintext highlighter-rouge">CP-&gt;Hubble=0.1</code>?</p> <h2 id="timestepping">Timestepping</h2> <h3 id="timelineconversions">Timeline/Conversions</h3> <p><strong>Basic variables</strong></p> <p>The simulated timespan is mapped onto the integer interval [0,TIMEBASE]</p> <p><em>Each integer time stores in the first 10 bits the snapshot number; Then the rest of the bits are the standard integer timeline, which should be a power-of-two hierarchy</em></p> <p>timebin是说bin的size</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>TIMEBINS=20
TIMEBASE = 2^21
MAXSNAPSHOTS = 2^11
dti_from_timebin(bin) = 2^(bin)
</code></pre></div></div> <p><strong>Sync points and output</strong></p> <p>2 « 1 = 4 and 2 « 2 = 8; 4 » 1 = 2 (and 5 » 1 = 2 since you round down); The bitwise representation of a is shifted left b bits. This is the same as multiplying by (2 to the power of b).</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	SyncPoints[0].a = TimeIC;
	SyncPoints[0].loga = log(TimeIC);
	
	SyncPoints[NSyncPoints].a = TimeMax;
    SyncPoints[NSyncPoints].loga = log(TimeMax);
        
    for(i = 0; i &lt; NSyncPoints; i++) {
        SyncPoints[i].ti = (i * 1L) &lt;&lt; (TIMEBINS);
    }
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">SyncPoints[i].ti</code>: first 11 bits=i; last 21 bits=0.</p> <p><code class="language-plaintext highlighter-rouge">setup_sync_points(Cosmology * CP, double TimeIC, double TimeMax, double no_snapshot_until_time, int SnapshotWithFOF)</code>: initialize all sync points, their time, loga, writeFOF, etc.. <code class="language-plaintext highlighter-rouge">no_snapshot_until_time</code> ensures that we do not write output before the restart snapshot, even if those redshifts appears in the output list.</p> <p><strong>Integer timeline and loga</strong></p> <p><em>Basically, the timeline is chopped into chunks based by syncpoints (snapshots), then the timeline between two consecutive snapshots is further divided into 2^21 ticks, everything is then in units of these ticks.</em></p> <p><code class="language-plaintext highlighter-rouge">Dloga_interval_ti(inttime_t ti)</code>: returns the dloga corresponding to dti=1 at the current ti (valid between last snap and next snap), i.e. <code class="language-plaintext highlighter-rouge">(SyncPoints[lastsnap+1].loga - SyncPoints[lastsnap].loga)/2^21</code>; this number will differ from snap to snap.</p> <p><code class="language-plaintext highlighter-rouge">loga_from_ti(inttime_t ti)</code>: returns the current loga, calculated from <code class="language-plaintext highlighter-rouge">SyncPoints[lastsnap].loga + dti * Dloga_interval_ti(ti)</code>, where <code class="language-plaintext highlighter-rouge">dti = ti - SyncPoints[lastsnap].ti</code> = the last 21 bits of ti?</p> <p><code class="language-plaintext highlighter-rouge">dloga_from_dti(inttime_t dti, const inttime_t Ti_Current)</code>: get the dloga from dti according to the current snapshot interval: <code class="language-plaintext highlighter-rouge">returns Dloga_interval_ti(Ti_Current) * dti</code> <em>but what if dti crosses the next snap?</em></p> <p><code class="language-plaintext highlighter-rouge">get_dloga_for_bin(int timebin, const inttime_t Ti_Current)</code>: returns the length of the time bin: <code class="language-plaintext highlighter-rouge">Dloga_interval_ti(Ti_Current) * 2^timebin</code></p> <p><code class="language-plaintext highlighter-rouge">init_timebins(TimeInit) = ti_from_loga(log(TimeInit))</code></p> <p><code class="language-plaintext highlighter-rouge">int is_timebin_active(int i, inttime_t current)</code> 如果current可以被第i个bin的长度整除（<code class="language-plaintext highlighter-rouge">dti_from_timebin(i)</code>），<strong>timebin</strong>而不是ti就active (ti=12的话，bin1，2 active，3不active). <strong>用法</strong>：<code class="language-plaintext highlighter-rouge">is_timebin_active(pp-&gt;TimeBinHydro, ti_current)</code>: 判断在某一个time ti，某一个particle的特定calculation是不是active.</p> <h3 id="timestep-calculations">Timestep calculations</h3> <p><strong>KD times</strong></p> <p><code class="language-plaintext highlighter-rouge">find_timesteps</code> (called before the second half kick): assign new timesteps to the active particles, now that we know they have synched TiKick and TiDrift, and advance the PM timestep.</p> <p><code class="language-plaintext highlighter-rouge">apply_half_kick(const ActiveParticles * act, Cosmology * CP, DriftKickTimes * times, const double atime)</code> 对每一个bin （1-20），<code class="language-plaintext highlighter-rouge">new_kick = times-&gt;Ti_kick[bin] + dti_from_timebin(bin)/2</code></p> <p>For each bin, plan to kick from <code class="language-plaintext highlighter-rouge">times-&gt;Ti_kick[bin]</code> to <code class="language-plaintext highlighter-rouge">times-&gt;Ti_kick[bin] + dti_from_timebin(bin)/2</code>, the kick factors are stored in <code class="language-plaintext highlighter-rouge">gravkick[bin]</code></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>if(is_timebin_active(bin_gravity, times-&gt;Ti_Current)) {
   		do_grav_short_range_kick(&amp;P[i], P[i].FullTreeGravAccel, gravkick[bin_gravity]);
   		do_hydro_kick(i, dt_entr, gravkick[bin_hydro], hydrokick[bin_hydro], atime);
</code></pre></div></div> <p>Note: <code class="language-plaintext highlighter-rouge">apply_hydro_half_kick</code> done separately only under hierarchical gravity</p> <p><strong>grav-timestep</strong></p> <p>Basically a small fraction of softening/acc</p> <p><code class="language-plaintext highlighter-rouge">get_timestep_gravity_dloga</code>: $dt = \sqrt{2 \epsilon_{\rm tol} \, a \, \epsilon_g / \mathbf{a}_{\rm grav}}$</p> <p><strong>hydro-timestep</strong></p> <p><em>ref: <a href="https://wwwmpa.mpa-garching.mpg.de/gadget4/gadget4-code-paper.pdf">gadget4 paper</a> Eq. 77-81</em></p> <ul> <li>local particle-based Courant-Friedrichs-Lewy (CFL) hydrodynamic timestep (smoothing length/sound speed)</li> </ul> \[\Delta t_i^{\mathrm{cfl}}=C_{\mathrm{CFL}} 2 h_i / v_i^{\mathrm{sig}, \max }\] <ul> <li>timestep criterion that restricts the al- lowed rate of change of the smoothing length (or equivalently den- sity) per timestep</li> </ul> \[\Delta t_i^{\mathrm{dens}}=C_{\mathrm{CFL}} \frac{h_i}{\left|\mathrm{~d} h_i / \mathrm{d} t\right|},\] <p><strong>long-range timestep</strong> <code class="language-plaintext highlighter-rouge">get_long_range_timestep_dloga</code>: just set PM step to maxtimebin for non-cosmological sim; pm step will be shortened to the longest tree timestep in find_timestep().</p> <h2 id="gravity">Gravity</h2> <p>Basic equation of motion (x: comoving) (<a href="https://arxiv.org/pdf/astro-ph/0411730.pdf">reference1</a>,<a href="https://arxiv.org/pdf/0801.1023.pdf">reference2</a>):</p> \[\ddot{x} + 2H(a)\dot{x} = \frac{1}{a}\,\nabla\phi\] \[\nabla^2\phi = 4\pi G \bar{\rho}(t)a^2\delta = \frac{3}{2}H_0 ^2\Omega_0 \frac{\delta}{a}\] \[\frac{\mathrm{d} \mathbf{v}}{\mathrm{d} t} =-\frac{\nabla \Phi}{a}-\mathbf{v} H(a)\] <p>where $\mathbf{v}$ is proper peculiar velocity.</p> <h3 id="pp-force">PP Force</h3> <p>In <code class="language-plaintext highlighter-rouge">gravshort_tree.c</code>:</p> <p><code class="language-plaintext highlighter-rouge">apply_accn_to_output</code>:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>fac = mass / (r2 * r);
for(i = 0; i &lt; 3; i++)
    output-&gt;Acc[i] += dx[i] * fac;
    output-&gt;Potential += facpot;
</code></pre></div></div> \[\phi(\mathbf{x})= -\sum_{j=1}^N \frac{m_j}{\left|\mathbf{x}_j-\mathbf{x}+\mathbf{q}_j^{\star}\right|+\epsilon\left(\left|\mathbf{x}_j-\mathbf{x}+\mathbf{q}_j^{\star}\right|\right)} +\sum_{j=1}^N m_j \psi\left(\mathbf{x}_j-\mathbf{x}+\mathbf{q}_j^{\star}\right)\] <h3 id="pm-force">PM Force</h3> <p>Reference: <a href="https://core.ac.uk/download/pdf/25290081.pdf">SUPERBOX paper</a></p> <p>Possion’s equation in real space (a convolution of density rho with the Green’s function H):</p> \[\Phi_{i j k}=G \sum_{a, b, c=0}^{N-1} \varrho_{a b c} \cdot H_{a-i, b-j, c-k}, \quad i, j, k=0, \ldots, N-1\] <p>where the Green’s function for gravivational potential is:</p> \[\begin{aligned} H_{i j k} &amp;=\frac{1}{\sqrt{i^2+j^2+k^2}}, \quad i, j, k=0,1, . ., N \\ H_{000} &amp;=4 / 3 . \end{aligned}\] <h3 id="units-and-scale-factors">units and scale factors</h3> <p>Scale factors</p> <p><code class="language-plaintext highlighter-rouge">P[i].Vel[k]</code> &lt;- $a\,v_{\rm pec}$;</p> <p><code class="language-plaintext highlighter-rouge">P[i].Pos[k]</code> &lt;- $x_{\rm prop}/a$;</p> <p><code class="language-plaintext highlighter-rouge">P[i].DFAccel[k]</code> &lt;- $a^2\,a_{\rm df}$;</p> <p>Code units</p> <p>velocity: $a\,km/s = 10^3\, m/s\;\times a$</p> <p>length: $kpc/h/a = 3.086\times 10^{19}\, m\;/h/a$;</p> <p>time: length/velocity = $[kpc]/[km/s] = 3.086e16\,s = 978\,Myr$; (any extra a or h?)</p> <p>acc: $a^2\times length/time^2 = [km/s]^2/[kpc] = 3.24 \times 10^{-14}\,m/s^2\;\times a^2$</p> <p>rho: $mass/length^2 = 1e10/h\,M_\odot/[kpc/h/a]^3 = 10^{10}\,a^3\,h^2 M_\odot/kpc^3 = 10\,a^3\,h^2 M_\odot/pc^3 = a^3\,h^2\;6.77\times 10^{-19}\,kg/m^3$</p> <h2 id="hydrosph">Hydro/SPH</h2> <p><strong>basic thermo relations</strong></p> <p>Equation of state \(P_i=u_i(\gamma-1) \rho_i\)</p> <p>Entropy function A \(P_i=A_i(s) \rho_i^\gamma\)</p> <p>Energy, entropy, density, and pressure \(u \equiv \bar{P}_i /\left[(\gamma-1) \bar{\rho}_i\right]=(\gamma-1)^{-1} A_i \bar{\rho}_i^{\gamma-1}\)</p> <p><strong>Euler equations</strong> (see <a href="https://www.ita.uni-heidelberg.de/~dullemond/lectures/num_fluid_2011/Chapter_12.pdf">here</a>)</p> \[\begin{gathered} \frac{\mathrm{d} \rho}{\mathrm{d} t}+\rho \nabla \cdot \mathbf{v}=0, \\ \frac{\mathrm{d} \mathbf{v}}{\mathrm{d} t}+\frac{\nabla P}{\rho}=0, \\ \frac{\mathrm{d} u}{\mathrm{~d} t}+\frac{P}{\rho} \nabla \cdot \mathbf{v}=0, \end{gathered}\] <p>where $\mathrm{d} / \mathrm{d} t=\partial / \partial t+\mathbf{v} \cdot \nabla$ is the convective derivative.</p> <p><strong>SPH formulation</strong></p> <p>Pressure-entropy formulation \(\bar{P}_i=y_i^\gamma=\left[\sum_{j=1}^N m_j A_j^{1 / \gamma} W_{i j}\left(h_i\right)\right]^\gamma\)</p> <p>sound speed in pressure-entropy sph: \(c_i = \sqrt{\gamma\,P_i/\rho_{u,i}}\) standard sph \(c_i = \sqrt{\gamma\,P_i/\rho_i}\)</p> <p>EOM: \(\begin{aligned} \frac{\mathrm{d} \mathbf{v}_i}{\mathrm{~d} t} &amp; =-\sum_{j=1}^N m_j\left(A_i A_j\right)^{\frac{1}{\gamma}}\left[\frac{f_i \bar{P}_i}{\bar{P}_i^{2 / \gamma}} \nabla_i W_{i j}\left(h_i\right)+\frac{f_j \bar{P}_j}{\bar{P}_j^{2 / \gamma}} \nabla_i W_{i j}\left(h_j\right)\right] \\ f_i &amp; =\left[1+\frac{h_i}{3 \bar{P}_i^{1 / \gamma}} \frac{\partial \bar{P}_i^{1 / \gamma}}{\partial h_i}\right]^{-1} \end{aligned}\)</p> <h3 id="entropy">entropy</h3> <p>in <code class="language-plaintext highlighter-rouge">init.c</code>: <code class="language-plaintext highlighter-rouge">SphP[i].Entropy = GAMMA_MINUS1 * u_init / pow(SphP[i].EgyWtDensity / a3 , GAMMA_MINUS1);</code></p> <p>in <code class="language-plaintext highlighter-rouge">winds.c</code>: <code class="language-plaintext highlighter-rouge">SPHP(other).Entropy += therm/enttou;</code></p> <p>in <code class="language-plaintext highlighter-rouge">sfr_eff.c</code>: <code class="language-plaintext highlighter-rouge">enttou = entropy_to_u(SPHP(i).Density, a3inv);</code></p> <p>in <code class="language-plaintext highlighter-rouge">blackhole.c</code>: <code class="language-plaintext highlighter-rouge">enttou = pow(SPHP(other).Density * BH_GET_PRIV(lv-&gt;tw)-&gt;a3inv, GAMMA_MINUS1) / GAMMA_MINUS1;</code></p> <p>\(s2u = (\rho/a^3)^{\gamma-1}/(\gamma - 1)\) (same as the basic thermal relation above)</p> <p><code class="language-plaintext highlighter-rouge">O-&gt;EgyRho += mass_j * EntVarPred * wk; SPHP(i).EgyWtDensity /= EntPred;</code></p> <h3 id="density-estimation-densityc">density estimation (density.c)</h3> <p>Initialize the kernel by type; calculate the gas particles within the kernel (depends on kernel type, 113 for quintic)</p> <pre><code class="language-double">GetNumNgb(enum DensityKernelType KernelType)
{
    DensityKernel kernel;
    density_kernel_init(&amp;kernel, 1.0, KernelType);
    return density_kernel_desnumngb(&amp;kernel, DensityParams.DensityResolutionEta);
}
</code></pre> <p><code class="language-plaintext highlighter-rouge">EntVarPred = exp(1./GAMMA * log(EntVarPred));</code> why??</p> <h3 id="hydrohydrac">hydro(hydra.c)</h3> <p><code class="language-plaintext highlighter-rouge">PressurePred(MyFloat EOMDensityPred, double EntVarPred)</code>: <code class="language-plaintext highlighter-rouge">return pow(EntVarPred * EOMDensityPred, GAMMA);</code> This is likely $\bar{P}<em>i=y_i^\gamma=\left[\sum</em>{j=1}^N m_j A_j^{1 / \gamma} W_{i j}\left(h_i\right)\right]^\gamma$</p> <p>Then ` HYDRA_GET_PRIV(tw)-&gt;PressurePred[i] = PressurePred(SPH_EOMDensity(&amp;SphP[i]), SPH_predicted-&gt;EntVarPred[i]);<code class="language-plaintext highlighter-rouge"> </code>SPH_EOMDensity` returns either Density or EgyWtDensity</p> <p>Key: <code class="language-plaintext highlighter-rouge">hfc += P[other].Mass * (dwk_i*iter-&gt;p_over_rho2_i*EntVarPred/I-&gt;EntVarPred + dwk_j*p_over_rho2_j*I-&gt;EntVarPred/EntVarPred) / r;</code></p> <p>hydro force added in <code class="language-plaintext highlighter-rouge">hydro.c</code>: <code class="language-plaintext highlighter-rouge">O-&gt;Acc[d] += (-hfc * dist[d]);</code> dist: distance</p> <p><code class="language-plaintext highlighter-rouge">TREEWALK_REDUCE(SPHP(place).HydroAccel[k], result-&gt;Acc[k]);</code></p> <p>###</p> <h2 id="heating-cooling-ionization-equilibrium">Heating, Cooling, ionization equilibrium</h2> <p>In cooling.c</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>double
get_neutral_fraction_phys_cgs(double density, double ienergy, double helium, const struct UVBG * uvbg, double * ne_init)                                                              
{
    double logt;
    double ne = get_equilib_ne(density, ienergy, helium, &amp;logt, uvbg, *ne_init);
    double nh = density * (1-helium);
    double photofac = self_shield_corr(nh, logt, uvbg-&gt;self_shield_dens);
    *ne_init = ne/nh;
    return nH0_internal(logt, ne, uvbg, photofac);
</code></pre></div></div> <p>Set of ionization equilibrium equations from KWH95:</p> \[\begin{aligned} n_{\mathrm{H}_0} &amp; =n_{\mathrm{H}} \alpha_{\mathrm{H}_{+}} /\left(\alpha_{\mathrm{H}_{+}}+\Gamma_{\mathrm{eH}_0}+\Gamma_{\gamma \mathrm{H}_0} / n_{\mathrm{e}}\right) \\ n_{\mathrm{H}_{+}} &amp; =n_{\mathrm{H}}-n_{\mathrm{H}_0}, \\ n_{\mathrm{He}_{+}} &amp; =y n_{\mathrm{H}} /\left[1+\left(\alpha_{\mathrm{He}_{+}}+\alpha_{\mathrm{d}}\right) /\left(\Gamma_{\mathrm{eHe}_0}+\Gamma_{\gamma \mathrm{He}_0} / n_{\mathrm{e}}\right)+\left(\Gamma_{\mathrm{eHe}_{+}}+\Gamma_{\gamma \mathrm{He}_{+}} / n_{\mathrm{e}}\right) / \alpha_{\mathrm{He}_{++}}\right] \\ n_{\mathrm{He}_0} &amp; =n_{\mathrm{He}_{+}}\left(\alpha_{\mathrm{He}_{+}}+\alpha_{\mathrm{d}}\right) /\left(\Gamma_{\mathrm{eHe}_0}+\Gamma_{\gamma \mathrm{He}_0} / n_{\mathrm{e}}\right) \\ n_{\mathrm{He}_{++}} &amp; =n_{\mathrm{He}_{+}}\left(\Gamma_{\mathrm{eHe}_{+}}+\Gamma_{\gamma \mathrm{He}_{+}} / n_{\mathrm{e}}\right) / \alpha_{\mathrm{He}_{++}} \\ n_{\mathrm{e}} &amp; =n_{\mathrm{H}_{+}}+n_{\mathrm{He}_{+}}+2 n_{\mathrm{He}_{++}} . \end{aligned}\] <h2 id="star-formation">Star-formation</h2> <blockquote> <p>“The star formation model is unchanged from Feng et al. (2016a), itself an implementation of Springel &amp; Hernquist (2003). Gas is allowed to cool both radiatively (Katz et al. 1996) and via metal line cooling. We include self-shielding of dense gas via the fitting function of Rahmati et al. (2013). We approximate the metal cooling rate by scaling a solar metallicity template according to the metallicity of gas particles, following Vogelsberger et al. (2014). We include a correction for the formation of molecular hydrogen, and its effect on star formation at low metallicities, according to the prescription by Krumholz &amp; Gnedin (2011). Stars are formed with 1/4 of the mass of a gas particle. Since we have also implemented mass return, the mass of a gas particle after forming 4 stars may exceed zero. To prevent runaway enrichment as gas cycles between a star and gas particle, the 5th star spawned from a gas particle contains the entire mass of the particle.”</p> </blockquote> <h2 id="winds-stellar-feedbacks">winds, stellar feedbacks</h2> <blockquote> <p>“A stellar wind feedback model (Okamoto et al. 2010) is included, which assumes wind speeds proportional to the local one dimensional dark matter velocity dispersion σDM: vw = κwσDM , (3) where vw is the wind speed. κw is a dimensionless parameter, which we take to be 3.7 following Vogelsberger et al. (2013). Winds are sourced by newly formed star particles, which randomly pick gas particles from within their SPH smoothing length to become wind particles. The total mass loading is (vw/350km/s)−2 where 350 km/s is in physical units. Once a particle is in the wind, it is hydrodynamically”</p> </blockquote> <h2 id="metal-return">Metal return</h2> <blockquote> <p>“We include a model for the return of mass and metal to the inter-stellar medium from massive stars. The general approach follows Vogelsberger et al. (2013); Pillepich et al. (2018a), although the implementation is independent and we have created our own metal yield tables. Each star particle is treated as a single stellar population, with the proportion of massive stars set by a Chabrier initial mass function (IMF) (Chabrier 2003). Massive stars have a finite lifetime, set using the lifetime tables of Portinari et al. (1998), and at the end of this lifetime they return mass and metal to neighbouring gas particles proportional to their fraction of the underlying stellar population. Nine metal species are followed: H, He, C, N, O, Ne, Mg, Si, Fe. The total metallicity is tracked separately. Metal and mass yields from AGB stars, SnII and Sn1A are pre-compiled and included as a function of mass and stellar metallicity. Stars with masses 1M − 8M are assumed to return via an Asymptotic Giant Branch (AGB) stage, with”</p> </blockquote> <h2 id="parallelization">Parallelization</h2> <p>Useful resources</p> <ul> <li><a href="https://charm.cs.illinois.edu/newPapers/08-03/paper.pdf">ChaNGa MPI paper</a></li> </ul>]]></content><author><name></name></author><category term="sample-posts"/><category term="toc"/><summary type="html"><![CDATA[an example of a blog post with table of contents]]></summary></entry><entry><title type="html">a post with giscus comments</title><link href="https://nianyic7.github.io/blog/2022/giscus-comments/" rel="alternate" type="text/html" title="a post with giscus comments"/><published>2022-12-10T15:59:00+00:00</published><updated>2022-12-10T15:59:00+00:00</updated><id>https://nianyic7.github.io/blog/2022/giscus-comments</id><content type="html" xml:base="https://nianyic7.github.io/blog/2022/giscus-comments/"><![CDATA[<p>This post shows how to add GISCUS comments.</p>]]></content><author><name></name></author><category term="sample-posts"/><category term="external-services"/><summary type="html"><![CDATA[an example of a blog post with giscus comments]]></summary></entry><entry><title type="html">Displaying External Posts on Your al-folio Blog</title><link href="https://nianyic7.github.io/blog/2022/displaying-external-posts-on-your-al-folio-blog/" rel="alternate" type="text/html" title="Displaying External Posts on Your al-folio Blog"/><published>2022-04-23T23:20:09+00:00</published><updated>2022-04-23T23:20:09+00:00</updated><id>https://nianyic7.github.io/blog/2022/displaying-external-posts-on-your-al-folio-blog</id><content type="html" xml:base="https://nianyic7.github.io/blog/2022/displaying-external-posts-on-your-al-folio-blog/"><![CDATA[]]></content><author><name></name></author></entry><entry><title type="html">a post with redirect</title><link href="https://nianyic7.github.io/blog/2022/redirect/" rel="alternate" type="text/html" title="a post with redirect"/><published>2022-02-01T17:39:00+00:00</published><updated>2022-02-01T17:39:00+00:00</updated><id>https://nianyic7.github.io/blog/2022/redirect</id><content type="html" xml:base="https://nianyic7.github.io/blog/2022/redirect/"><![CDATA[<p>Redirecting to another page.</p>]]></content><author><name></name></author><summary type="html"><![CDATA[you can also redirect to assets like pdf]]></summary></entry><entry><title type="html">a post with diagrams</title><link href="https://nianyic7.github.io/blog/2021/diagrams/" rel="alternate" type="text/html" title="a post with diagrams"/><published>2021-07-04T17:39:00+00:00</published><updated>2021-07-04T17:39:00+00:00</updated><id>https://nianyic7.github.io/blog/2021/diagrams</id><content type="html" xml:base="https://nianyic7.github.io/blog/2021/diagrams/"><![CDATA[<p>This theme supports generating various diagrams from a text description using <a href="https://github.com/zhustec/jekyll-diagrams" target="\_blank">jekyll-diagrams</a> plugin. Below, we generate a few examples of such diagrams using languages such as <a href="https://mermaid-js.github.io/mermaid/" target="\_blank">mermaid</a>, <a href="https://plantuml.com/" target="\_blank">plantuml</a>, <a href="https://vega.github.io/vega-lite/" target="\_blank">vega-lite</a>, etc.</p> <p><strong>Note:</strong> different diagram-generation packages require external dependencies to be installed on your machine. Also, be mindful of that because of diagram generation the fist time you build your Jekyll website after adding new diagrams will be SLOW. For any other details, please refer to <a href="https://github.com/zhustec/jekyll-diagrams" target="\_blank">jekyll-diagrams</a> README.</p> <h2 id="mermaid">Mermaid</h2> <p>Install mermaid using <code class="language-plaintext highlighter-rouge">node.js</code> package manager <code class="language-plaintext highlighter-rouge">npm</code> by running the following command:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm <span class="nb">install</span> <span class="nt">-g</span> mermaid.cli
</code></pre></div></div> <p>The diagram below was generated by the following code:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{% mermaid %}
sequenceDiagram
    participant John
    participant Alice
    Alice-&gt;&gt;John: Hello John, how are you?
    John--&gt;&gt;Alice: Great!
{% endmermaid %}
</code></pre></div></div> <div class="jekyll-diagrams diagrams mermaid"> <svg id="mermaid-1692297623486" width="100%" xmlns="http://www.w3.org/2000/svg" height="100%" style="max-width:450px;" viewBox="-50 -10 450 231"><style>#mermaid-1692297623486 .label{font-family:trebuchet ms,verdana,arial;color:#333}#mermaid-1692297623486 .node circle,#mermaid-1692297623486 .node ellipse,#mermaid-1692297623486 .node polygon,#mermaid-1692297623486 .node rect{fill:#ececff;stroke:#9370db;stroke-width:1px}#mermaid-1692297623486 .node.clickable{cursor:pointer}#mermaid-1692297623486 .arrowheadPath{fill:#333}#mermaid-1692297623486 .edgePath .path{stroke:#333;stroke-width:1.5px}#mermaid-1692297623486 .edgeLabel{background-color:#e8e8e8}#mermaid-1692297623486 .cluster rect{fill:#ffffde!important;stroke:#aa3!important;stroke-width:1px!important}#mermaid-1692297623486 .cluster text{fill:#333}#mermaid-1692297623486 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:trebuchet ms,verdana,arial;font-size:12px;background:#ffffde;border:1px solid #aa3;border-radius:2px;pointer-events:none;z-index:100}#mermaid-1692297623486 .actor{stroke:#ccf;fill:#ececff}#mermaid-1692297623486 text.actor{fill:#000;stroke:none}#mermaid-1692297623486 .actor-line{stroke:grey}#mermaid-1692297623486 .messageLine0{marker-end:"url(#arrowhead)"}#mermaid-1692297623486 .messageLine0,#mermaid-1692297623486 .messageLine1{stroke-width:1.5;stroke-dasharray:"2 2";stroke:#333}#mermaid-1692297623486 #arrowhead{fill:#333}#mermaid-1692297623486 #crosshead path{fill:#333!important;stroke:#333!important}#mermaid-1692297623486 .messageText{fill:#333;stroke:none}#mermaid-1692297623486 .labelBox{stroke:#ccf;fill:#ececff}#mermaid-1692297623486 .labelText,#mermaid-1692297623486 .loopText{fill:#000;stroke:none}#mermaid-1692297623486 .loopLine{stroke-width:2;stroke-dasharray:"2 2";marker-end:"url(#arrowhead)";stroke:#ccf}#mermaid-1692297623486 .note{stroke:#aa3;fill:#fff5ad}#mermaid-1692297623486 .noteText{fill:#000;stroke:none;font-family:trebuchet ms,verdana,arial;font-size:14px}#mermaid-1692297623486 .section{stroke:none;opacity:.2}#mermaid-1692297623486 .section0{fill:rgba(102,102,255,.49)}#mermaid-1692297623486 .section2{fill:#fff400}#mermaid-1692297623486 .section1,#mermaid-1692297623486 .section3{fill:#fff;opacity:.2}#mermaid-1692297623486 .sectionTitle0,#mermaid-1692297623486 .sectionTitle1,#mermaid-1692297623486 .sectionTitle2,#mermaid-1692297623486 .sectionTitle3{fill:#333}#mermaid-1692297623486 .sectionTitle{text-anchor:start;font-size:11px;text-height:14px}#mermaid-1692297623486 .grid .tick{stroke:#d3d3d3;opacity:.3;shape-rendering:crispEdges}#mermaid-1692297623486 .grid path{stroke-width:0}#mermaid-1692297623486 .today{fill:none;stroke:red;stroke-width:2px}#mermaid-1692297623486 .task{stroke-width:2}#mermaid-1692297623486 .taskText{text-anchor:middle;font-size:11px}#mermaid-1692297623486 .taskTextOutsideRight{fill:#000;text-anchor:start;font-size:11px}#mermaid-1692297623486 .taskTextOutsideLeft{fill:#000;text-anchor:end;font-size:11px}#mermaid-1692297623486 .taskText0,#mermaid-1692297623486 .taskText1,#mermaid-1692297623486 .taskText2,#mermaid-1692297623486 .taskText3{fill:#fff}#mermaid-1692297623486 .task0,#mermaid-1692297623486 .task1,#mermaid-1692297623486 .task2,#mermaid-1692297623486 .task3{fill:#8a90dd;stroke:#534fbc}#mermaid-1692297623486 .taskTextOutside0,#mermaid-1692297623486 .taskTextOutside1,#mermaid-1692297623486 .taskTextOutside2,#mermaid-1692297623486 .taskTextOutside3{fill:#000}#mermaid-1692297623486 .active0,#mermaid-1692297623486 .active1,#mermaid-1692297623486 .active2,#mermaid-1692297623486 .active3{fill:#bfc7ff;stroke:#534fbc}#mermaid-1692297623486 .activeText0,#mermaid-1692297623486 .activeText1,#mermaid-1692297623486 .activeText2,#mermaid-1692297623486 .activeText3{fill:#000!important}#mermaid-1692297623486 .done0,#mermaid-1692297623486 .done1,#mermaid-1692297623486 .done2,#mermaid-1692297623486 .done3{stroke:grey;fill:#d3d3d3;stroke-width:2}#mermaid-1692297623486 .doneText0,#mermaid-1692297623486 .doneText1,#mermaid-1692297623486 .doneText2,#mermaid-1692297623486 .doneText3{fill:#000!important}#mermaid-1692297623486 .crit0,#mermaid-1692297623486 .crit1,#mermaid-1692297623486 .crit2,#mermaid-1692297623486 .crit3{stroke:#f88;fill:red;stroke-width:2}#mermaid-1692297623486 .activeCrit0,#mermaid-1692297623486 .activeCrit1,#mermaid-1692297623486 .activeCrit2,#mermaid-1692297623486 .activeCrit3{stroke:#f88;fill:#bfc7ff;stroke-width:2}#mermaid-1692297623486 .doneCrit0,#mermaid-1692297623486 .doneCrit1,#mermaid-1692297623486 .doneCrit2,#mermaid-1692297623486 .doneCrit3{stroke:#f88;fill:#d3d3d3;stroke-width:2;cursor:pointer;shape-rendering:crispEdges}#mermaid-1692297623486 .activeCritText0,#mermaid-1692297623486 .activeCritText1,#mermaid-1692297623486 .activeCritText2,#mermaid-1692297623486 .activeCritText3,#mermaid-1692297623486 .doneCritText0,#mermaid-1692297623486 .doneCritText1,#mermaid-1692297623486 .doneCritText2,#mermaid-1692297623486 .doneCritText3{fill:#000!important}#mermaid-1692297623486 .titleText{text-anchor:middle;font-size:18px;fill:#000}
#mermaid-1692297623486 g.classGroup text{fill:#9370db;stroke:none;font-family:trebuchet ms,verdana,arial;font-size:10px}#mermaid-1692297623486 g.classGroup rect{fill:#ececff;stroke:#9370db}#mermaid-1692297623486 g.classGroup line{stroke:#9370db;stroke-width:1}#mermaid-1692297623486 .classLabel .box{stroke:none;stroke-width:0;fill:#ececff;opacity:.5}#mermaid-1692297623486 .classLabel .label{fill:#9370db;font-size:10px}#mermaid-1692297623486 .relation{stroke:#9370db;stroke-width:1;fill:none}#mermaid-1692297623486 #compositionEnd,#mermaid-1692297623486 #compositionStart{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-1692297623486 #aggregationEnd,#mermaid-1692297623486 #aggregationStart{fill:#ececff;stroke:#9370db;stroke-width:1}#mermaid-1692297623486 #dependencyEnd,#mermaid-1692297623486 #dependencyStart,#mermaid-1692297623486 #extensionEnd,#mermaid-1692297623486 #extensionStart{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-1692297623486 .branch-label,#mermaid-1692297623486 .commit-id,#mermaid-1692297623486 .commit-msg{fill:#d3d3d3;color:#d3d3d3}</style><style>#mermaid-1692297623486{color:#000;font:normal normal 400 normal 16px / normal "Times New Roman"}</style><g></g><g><line id="actor0" x1="75" y1="5" x2="75" y2="220" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="0" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="75" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle;"><tspan x="75" dy="0">John</tspan></text></g><g><line id="actor1" x1="275" y1="5" x2="275" y2="220" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="200" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="275" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle;"><tspan x="275" dy="0">Alice</tspan></text></g><defs><marker id="arrowhead" refX="5" refY="2" markerWidth="6" markerHeight="4" orient="auto"><path d="M 0,0 V 4 L6,2 Z"></path></marker></defs><defs><marker id="crosshead" markerWidth="15" markerHeight="8" orient="auto" refX="16" refY="4"><path fill="black" stroke="#000000" stroke-width="1px" d="M 9,2 V 6 L16,4 Z" style="stroke-dasharray: 0, 0;"></path><path fill="none" stroke="#000000" stroke-width="1px" d="M 0,1 L 6,7 M 6,1 L 0,7" style="stroke-dasharray: 0, 0;"></path></marker></defs><g><text x="175" y="93" class="messageText" style="text-anchor: middle;">Hello John, how are you?</text><line x1="275" y1="100" x2="75" y2="100" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><text x="175" y="128" class="messageText" style="text-anchor: middle;">Great!</text><line x1="75" y1="135" x2="275" y2="135" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><rect x="0" y="155" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="75" y="187.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle;"><tspan x="75" dy="0">John</tspan></text></g><g><rect x="200" y="155" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="275" y="187.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle;"><tspan x="275" dy="0">Alice</tspan></text></g></svg> </div>]]></content><author><name></name></author><summary type="html"><![CDATA[an example of a blog post with diagrams]]></summary></entry></feed>